name: Test1

on:
  workflow_dispatch

jobs:
  dyff:
    name: yaml diff
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      - name: Install tools
        run: |
          sudo snap install dyff
          dyff version
      - name: Download yaml
        run: |
          PUBY="https://ica.illumina.com/ica/api/swagger/openapi_public.yaml"
          TMPY="openapi_tmp.yaml"
          CURY="openapi_current.yaml"

          curl -o ${TMPY} ${PUBY}
          { dyff between --omit-header --set-exit-code ${TMPY} ${CURY} && echo "SAME"; } || { cp ${TMPY} ${CURY} && echo "COPIED"; }

